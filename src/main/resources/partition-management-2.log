<14>1 2019-03-24T07:29:48.503Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 48
<14>1 2019-03-24T07:29:49.136Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Found 43 candidate tables for partition discovery
<14>1 2019-03-24T07:29:49.136Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.bucketing_cols retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.137Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.cds retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.137Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.columns_v2 retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.137Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.database_params retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.137Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.db_privs retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.137Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.dbs retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.global_privs retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.partition_keys retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.partitions retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.partition_key_vals retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.partition_params retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.part_col_privs retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.part_privs retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.roles retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.role_map retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.sds retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.sd_params retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.sequence_table retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.serde_params retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.serdes retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.skewed_col_names retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.skewed_col_value_loc_map retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.skewed_string_list retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.skewed_string_list_values retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.skewed_values retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.sort_cols retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.mv_creation_metadata retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.table_params retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.tbls retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.mv_tables_used retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.tbl_col_privs retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.tab_col_stats retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.tbl_privs retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.part_col_stats retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.db_version retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.funcs retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.key_constraints retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.wm_resourceplans retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.138Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.wm_triggers retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.139Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.wm_mappings retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.139Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.wm_pools retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.139Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.wm_pools_to_triggers retentionPeriod: -1s
<14>1 2019-03-24T07:29:49.139Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.PartitionManagementTask" level="INFO" thread="pool-7-thread-8"] Running partition discovery for table hive.sys.logs retentionPeriod: 86400s
<12>1 2019-03-24T07:29:50.731Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then TO_DATE("FILTER0"."PART_KEY_VAL", 'YYYY-MM-DD') else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then TO_DATE("FILTER0"."PART_KEY_VAL", 'YYYY-MM-DD') else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 895	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<11>1 2019-03-24T07:29:50.735Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.ObjectStore" level="ERROR" thread="PartitionDiscoveryTask-1"]javax.jdo.JDOException: Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0"	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:677)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:255)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesNoTxn(ObjectStore.java:3240)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesPrunedByExprNoTxn(ObjectStore.java:3479)	at org.apache.hadoop.hive.metastore.ObjectStore.access$800(ObjectStore.java:252)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3447)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3711)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: current transaction is aborted, commands ignored until end of transaction block	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.JDOQLQuery.performExecute(JDOQLQuery.java:617)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.query.Query.executeWithArray(Query.java:1744)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:255)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesNoTxn(ObjectStore.java:3240)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesPrunedByExprNoTxn(ObjectStore.java:3479)	at org.apache.hadoop.hive.metastore.ObjectStore.access$800(ObjectStore.java:252)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3447)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3711)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<11>1 2019-03-24T07:29:50.738Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.RetryingHMSHandler" level="ERROR" thread="PartitionDiscoveryTask-1"] MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3720)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T07:29:50.738Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="utils.RetryUtilities$ExponentiallyDecayingBatchWork" level="WARN" thread="PartitionDiscoveryTask-1"] Exception thrown while processing using a batch size 3000org.apache.hadoop.hive.metastore.utils.MetastoreException: MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:483)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)Caused by: MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3720)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	... 10 more
<12>1 2019-03-24T07:29:50.752Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then TO_DATE("FILTER0"."PART_KEY_VAL", 'YYYY-MM-DD') else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then TO_DATE("FILTER0"."PART_KEY_VAL", 'YYYY-MM-DD') else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 895	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<11>1 2019-03-24T07:29:50.753Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.ObjectStore" level="ERROR" thread="PartitionDiscoveryTask-1"]javax.jdo.JDOException: Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0"	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:677)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:255)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesNoTxn(ObjectStore.java:3240)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesPrunedByExprNoTxn(ObjectStore.java:3479)	at org.apache.hadoop.hive.metastore.ObjectStore.access$800(ObjectStore.java:252)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3447)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3711)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: current transaction is aborted, commands ignored until end of transaction block	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.JDOQLQuery.performExecute(JDOQLQuery.java:617)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.query.Query.executeWithArray(Query.java:1744)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:255)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesNoTxn(ObjectStore.java:3240)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesPrunedByExprNoTxn(ObjectStore.java:3479)	at org.apache.hadoop.hive.metastore.ObjectStore.access$800(ObjectStore.java:252)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3447)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3711)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<11>1 2019-03-24T07:29:50.755Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.RetryingHMSHandler" level="ERROR" thread="PartitionDiscoveryTask-1"] MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3720)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T07:29:50.755Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="utils.RetryUtilities$ExponentiallyDecayingBatchWork" level="WARN" thread="PartitionDiscoveryTask-1"] Exception thrown while processing using a batch size 1500org.apache.hadoop.hive.metastore.utils.MetastoreException: MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:483)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)Caused by: MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3720)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	... 10 more
<12>1 2019-03-24T07:29:50.770Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then TO_DATE("FILTER0"."PART_KEY_VAL", 'YYYY-MM-DD') else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then TO_DATE("FILTER0"."PART_KEY_VAL", 'YYYY-MM-DD') else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 895	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<11>1 2019-03-24T07:29:50.772Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.ObjectStore" level="ERROR" thread="PartitionDiscoveryTask-1"]javax.jdo.JDOException: Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0"	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:677)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:255)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesNoTxn(ObjectStore.java:3240)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesPrunedByExprNoTxn(ObjectStore.java:3479)	at org.apache.hadoop.hive.metastore.ObjectStore.access$800(ObjectStore.java:252)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3447)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3711)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: current transaction is aborted, commands ignored until end of transaction block	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.JDOQLQuery.performExecute(JDOQLQuery.java:617)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.query.Query.executeWithArray(Query.java:1744)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:255)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesNoTxn(ObjectStore.java:3240)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesPrunedByExprNoTxn(ObjectStore.java:3479)	at org.apache.hadoop.hive.metastore.ObjectStore.access$800(ObjectStore.java:252)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3447)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3711)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<11>1 2019-03-24T07:29:50.773Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.RetryingHMSHandler" level="ERROR" thread="PartitionDiscoveryTask-1"] MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3720)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T07:29:50.773Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="utils.RetryUtilities$ExponentiallyDecayingBatchWork" level="WARN" thread="PartitionDiscoveryTask-1"] Exception thrown while processing using a batch size 750org.apache.hadoop.hive.metastore.utils.MetastoreException: MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:483)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)Caused by: MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3720)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	... 10 more
<12>1 2019-03-24T07:29:50.787Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then TO_DATE("FILTER0"."PART_KEY_VAL", 'YYYY-MM-DD') else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then TO_DATE("FILTER0"."PART_KEY_VAL", 'YYYY-MM-DD') else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 895	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<11>1 2019-03-24T07:29:50.789Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.ObjectStore" level="ERROR" thread="PartitionDiscoveryTask-1"]javax.jdo.JDOException: Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0"	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:677)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:255)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesNoTxn(ObjectStore.java:3240)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesPrunedByExprNoTxn(ObjectStore.java:3479)	at org.apache.hadoop.hive.metastore.ObjectStore.access$800(ObjectStore.java:252)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3447)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3711)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: current transaction is aborted, commands ignored until end of transaction block	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.JDOQLQuery.performExecute(JDOQLQuery.java:617)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.query.Query.executeWithArray(Query.java:1744)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:255)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesNoTxn(ObjectStore.java:3240)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionNamesPrunedByExprNoTxn(ObjectStore.java:3479)	at org.apache.hadoop.hive.metastore.ObjectStore.access$800(ObjectStore.java:252)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3447)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getJdoResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3711)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<11>1 2019-03-24T07:29:50.791Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.RetryingHMSHandler" level="ERROR" thread="PartitionDiscoveryTask-1"] MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3720)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:475)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T07:29:50.792Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 ae7f206d-4e05-11e9-83d0-02c17ec35ac0 [mdc@18060 class="utils.RetryUtilities$ExponentiallyDecayingBatchWork" level="WARN" thread="PartitionDiscoveryTask-1"] Exception thrown while processing using a batch size 375org.apache.hadoop.hive.metastore.utils.MetastoreException: MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:483)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:436)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:500)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:227)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)Caused by: MetaException(message:Exception thrown when executing query : SELECT "A0"."PART_NAME","A0"."PART_NAME" AS "NUCORDER0" FROM "PARTITIONS" "A0" LEFT OUTER JOIN "TBLS" "B0" ON "A0"."TBL_ID" = "B0"."TBL_ID" LEFT OUTER JOIN "DBS" "C0" ON "B0"."DB_ID" = "C0"."DB_ID" WHERE "C0"."NAME" = ? AND "B0"."TBL_NAME" = ? AND "C0"."CTLG_NAME" = ? ORDER BY "NUCORDER0")	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3720)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(Re