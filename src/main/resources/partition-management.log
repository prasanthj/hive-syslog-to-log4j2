<14>1 2019-03-24T03:44:59.420Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1156: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T03:44:59.420Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T03:44:59.429Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1156: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T03:44:59.429Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T03:44:59.438Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1156: get_partition_names : tbl=hive.sys.logs
<14>1 2019-03-24T03:44:59.438Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.sys.logs	
<14>1 2019-03-24T03:44:59.454Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1156: get_partitions_by_names : tbl=hive.sys.logs
<14>1 2019-03-24T03:44:59.454Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.sys.logs	
<14>1 2019-03-24T03:44:59.517Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStoreChecker" level="INFO" thread="PartitionDiscoveryTask-1"] Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<12>1 2019-03-24T03:44:59.532Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:44:59.546Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:44:59.559Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:44:59.571Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<14>1 2019-03-24T03:44:59.573Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.Msck" level="INFO" thread="PartitionDiscoveryTask-1"] Expired partitions: [logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<14>1 2019-03-24T03:49:59.361Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-2"] 1160: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T03:49:59.361Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-2"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T03:49:59.370Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-2"] 1160: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T03:49:59.370Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-2"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T03:49:59.379Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-2"] 1160: get_partition_names : tbl=hive.sys.logs
<14>1 2019-03-24T03:49:59.379Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-2"] ugi=hive	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.sys.logs	
<14>1 2019-03-24T03:49:59.395Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-2"] 1160: get_partitions_by_names : tbl=hive.sys.logs
<14>1 2019-03-24T03:49:59.395Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-2"] ugi=hive	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.sys.logs	
<14>1 2019-03-24T03:49:59.464Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStoreChecker" level="INFO" thread="PartitionDiscoveryTask-2"] Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<12>1 2019-03-24T03:49:59.475Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-2"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:49:59.492Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-2"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:49:59.508Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-2"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:49:59.521Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-2"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<14>1 2019-03-24T03:49:59.524Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.Msck" level="INFO" thread="PartitionDiscoveryTask-2"] Expired partitions: [logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<14>1 2019-03-24T03:54:59.458Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-2"] 1163: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T03:54:59.458Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-2"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T03:54:59.467Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-2"] 1163: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T03:54:59.468Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-2"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T03:54:59.477Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-2"] 1163: get_partition_names : tbl=hive.sys.logs
<14>1 2019-03-24T03:54:59.477Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-2"] ugi=hive	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.sys.logs	
<14>1 2019-03-24T03:54:59.492Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-2"] 1163: get_partitions_by_names : tbl=hive.sys.logs
<14>1 2019-03-24T03:54:59.492Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-2"] ugi=hive	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.sys.logs	
<14>1 2019-03-24T03:54:59.569Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStoreChecker" level="INFO" thread="PartitionDiscoveryTask-2"] Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<12>1 2019-03-24T03:54:59.580Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-2"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:54:59.594Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-2"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:54:59.607Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-2"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:54:59.619Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-2"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<14>1 2019-03-24T03:54:59.627Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.Msck" level="INFO" thread="PartitionDiscoveryTask-2"] Expired partitions: [logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<14>1 2019-03-24T03:59:59.500Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1165: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T03:59:59.501Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T03:59:59.510Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1165: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T03:59:59.510Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T03:59:59.519Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1165: get_partition_names : tbl=hive.sys.logs
<14>1 2019-03-24T03:59:59.519Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.sys.logs	
<14>1 2019-03-24T03:59:59.533Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1165: get_partitions_by_names : tbl=hive.sys.logs
<14>1 2019-03-24T03:59:59.533Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.sys.logs	
<14>1 2019-03-24T03:59:59.591Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStoreChecker" level="INFO" thread="PartitionDiscoveryTask-0"] Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<12>1 2019-03-24T03:59:59.603Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:59:59.615Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:59:59.627Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T03:59:59.639Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<14>1 2019-03-24T03:59:59.642Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.Msck" level="INFO" thread="PartitionDiscoveryTask-0"] Expired partitions: [logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<14>1 2019-03-24T04:04:59.544Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1170: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T04:04:59.544Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T04:04:59.554Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1170: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T04:04:59.554Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T04:04:59.563Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1170: get_partition_names : tbl=hive.sys.logs
<14>1 2019-03-24T04:04:59.564Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.sys.logs	
<14>1 2019-03-24T04:04:59.579Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1170: get_partitions_by_names : tbl=hive.sys.logs
<14>1 2019-03-24T04:04:59.579Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.sys.logs	
<14>1 2019-03-24T04:04:59.651Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStoreChecker" level="INFO" thread="PartitionDiscoveryTask-1"] Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<12>1 2019-03-24T04:04:59.664Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:04:59.680Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:04:59.694Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:04:59.706Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<14>1 2019-03-24T04:04:59.709Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.Msck" level="INFO" thread="PartitionDiscoveryTask-1"] Expired partitions: [logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<14>1 2019-03-24T04:09:59.630Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1171: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T04:09:59.630Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T04:09:59.640Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1171: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T04:09:59.640Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T04:09:59.648Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1171: get_partition_names : tbl=hive.sys.logs
<14>1 2019-03-24T04:09:59.648Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.sys.logs	
<14>1 2019-03-24T04:09:59.665Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1171: get_partitions_by_names : tbl=hive.sys.logs
<14>1 2019-03-24T04:09:59.665Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.sys.logs	
<14>1 2019-03-24T04:09:59.737Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStoreChecker" level="INFO" thread="PartitionDiscoveryTask-0"] Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<12>1 2019-03-24T04:09:59.749Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:09:59.762Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:09:59.776Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:09:59.789Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<14>1 2019-03-24T04:09:59.792Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.Msck" level="INFO" thread="PartitionDiscoveryTask-0"] Expired partitions: [logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<14>1 2019-03-24T04:14:59.588Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1174: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T04:14:59.588Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T04:14:59.598Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1174: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T04:14:59.598Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T04:14:59.608Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1174: get_partition_names : tbl=hive.sys.logs
<14>1 2019-03-24T04:14:59.608Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.sys.logs	
<14>1 2019-03-24T04:14:59.622Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1174: get_partitions_by_names : tbl=hive.sys.logs
<14>1 2019-03-24T04:14:59.622Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.sys.logs	
<14>1 2019-03-24T04:14:59.687Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStoreChecker" level="INFO" thread="PartitionDiscoveryTask-0"] Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<12>1 2019-03-24T04:14:59.698Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:14:59.711Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:14:59.723Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:14:59.736Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<14>1 2019-03-24T04:14:59.741Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.Msck" level="INFO" thread="PartitionDiscoveryTask-0"] Expired partitions: [logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<14>1 2019-03-24T04:19:59.419Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1177: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T04:19:59.419Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T04:19:59.428Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1177: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T04:19:59.428Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T04:19:59.437Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1177: get_partition_names : tbl=hive.sys.logs
<14>1 2019-03-24T04:19:59.437Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.sys.logs	
<14>1 2019-03-24T04:19:59.453Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-1"] 1177: get_partitions_by_names : tbl=hive.sys.logs
<14>1 2019-03-24T04:19:59.453Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-1"] ugi=hive	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.sys.logs	
<14>1 2019-03-24T04:19:59.531Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStoreChecker" level="INFO" thread="PartitionDiscoveryTask-1"] Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<12>1 2019-03-24T04:19:59.542Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:19:59.555Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:19:59.570Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:19:59.582Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-1"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<14>1 2019-03-24T04:19:59.590Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.Msck" level="INFO" thread="PartitionDiscoveryTask-1"] Expired partitions: [logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<14>1 2019-03-24T04:24:59.450Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1180: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T04:24:59.450Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T04:24:59.463Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1180: get_table : tbl=hive.sys.logs
<14>1 2019-03-24T04:24:59.463Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_table : tbl=hive.sys.logs	
<14>1 2019-03-24T04:24:59.475Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1180: get_partition_names : tbl=hive.sys.logs
<14>1 2019-03-24T04:24:59.475Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.sys.logs	
<14>1 2019-03-24T04:24:59.490Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStore" level="INFO" thread="PartitionDiscoveryTask-0"] 1180: get_partitions_by_names : tbl=hive.sys.logs
<14>1 2019-03-24T04:24:59.490Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="HiveMetaStore.audit" level="INFO" thread="PartitionDiscoveryTask-0"] ugi=hive	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.sys.logs	
<14>1 2019-03-24T04:24:59.559Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.HiveMetaStoreChecker" level="INFO" thread="PartitionDiscoveryTask-0"] Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore, logs:dt=2019-03-23/ns=warehouse-1553300821-692w/app=metastore-db-create-job]
<12>1 2019-03-24T04:24:59.570Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:24:59.583Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:24:59.597Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)
<12>1 2019-03-24T04:24:59.610Z metastore-0.metastore-service.warehouse-1553300821-692w.svc.cluster.local metastore 1 66616fae-4d02-11e9-83d0-02c17ec35ac0 [mdc@18060 class="metastore.MetaStoreDirectSql" level="WARN" thread="PartitionDiscoveryTask-0"] Failed to execute [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )] with parameters [logs, sys, hive, __HIVE_DEFAULT_PARTITION__, logs, sys, hive, 2019-03-23, warehouse-1553300821-692w, metastore-db-create-job]javax.jdo.JDODataStoreException: Error executing SQL query "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 inner join "PARTITION_KEY_VALS" "FILTER2" on "FILTER2"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER2"."INTEGER_IDX" = 2 where "DBS"."CTLG_NAME" = ?  and ( ( (((case when "FILTER0"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 then cast("FILTER0"."PART_KEY_VAL" as date) else null end) = ?) and ("FILTER1"."PART_KEY_VAL" = ?))  and ("FILTER2"."PART_KEY_VAL" = ?)) )".	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:3702)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExprInternal(ObjectStore.java:3453)	at org.apache.hadoop.hive.metastore.ObjectStore.getPartitionsByExpr(ObjectStore.java:3406)	at sun.reflect.GeneratedMethodAccessor82.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)	at com.sun.proxy.$Proxy33.getPartitionsByExpr(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.drop_partitions_req(HiveMetaStore.java:4521)	at sun.reflect.GeneratedMethodAccessor84.invoke(Unknown Source)	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)	at java.lang.reflect.Method.invoke(Method.java:498)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)	at com.sun.proxy.$Proxy34.drop_partitions_req(Unknown Source)	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropPartitions(HiveMetaStoreClient.java:1288)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:474)	at org.apache.hadoop.hive.metastore.Msck$2.execute(Msck.java:435)	at org.apache.hadoop.hive.metastore.utils.RetryUtilities$ExponentiallyDecayingBatchWork.run(RetryUtilities.java:91)	at org.apache.hadoop.hive.metastore.Msck.dropPartitionsInBatches(Msck.java:499)	at org.apache.hadoop.hive.metastore.Msck.repair(Msck.java:226)	at org.apache.hadoop.hive.metastore.PartitionManagementTask$MsckThread.run(PartitionManagementTask.java:213)	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)	at java.util.concurrent.FutureTask.run(FutureTask.java:266)	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)	at java.lang.Thread.run(Thread.java:748)NestedThrowablesStackTrace:org.postgresql.util.PSQLException: ERROR: operator does not exist: date = character varying  Hint: No operator matches the given name and argument type(s). You might need to add explicit type casts.  Position: 886	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2284)	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2003)	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:200)	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:424)	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:161)	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:114)	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeQuery(ParamLoggingPreparedStatement.java:375)	at org.datanucleus.store.rdbms.SQLController.executeStatementQuery(SQLController.java:552)	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:645)	at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:368)	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:267)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.executeWithArray(MetaStoreDirectSql.java:2042)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionIdsViaSqlFilter(MetaStoreDirectSql.java:621)	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getPartitionsViaSqlFilter(MetaStoreDirectSql.java:487)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3426)	at org.apache.hadoop.hive.metastore.ObjectStore$9.getSqlResult(ObjectStore.java:3418)	at 